<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora NPT | Nutrici√≥n Parenteral UCI</title>
    <meta name="description"
        content="Calculadora avanzada para Nutrici√≥n Parenteral en Paciente Cr√≠tico. UCI, Anestesia y Reanimaci√≥n.">

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body data-theme="dark">

    <div class="app-container">
        <!-- Header -->
        <header class="card" style="display:flex; justify-content:space-between; align-items:center;">
            <div>
                <h1>Calculadora NPT <span class="text-sm text-muted" style="font-weight:400">v5.0</span></h1>
                <p class="text-sm text-muted">Nutrici√≥n Parenteral en Paciente Cr√≠tico</p>
            </div>
            <div class="header-actions">
                <button id="theme-toggle" class="btn btn-secondary btn-icon" title="Cambiar Tema">
                    üåó
                </button>
            </div>
        </header>

        <!-- LEFT PANEL: Inputs -->
        <aside class="input-panel">
            <div class="card">
                <h2>1. Datos del Paciente</h2>

                <div class="grid-2">
                    <div class="form-group">
                        <label for="edad">Edad (a√±os)</label>
                        <input type="number" id="edad" value="65" min="14" max="120">
                    </div>
                    <div class="form-group">
                        <label for="sexo">Sexo</label>
                        <select id="sexo">
                            <option value="H">Var√≥n</option>
                            <option value="M">Mujer</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label for="peso">Peso (kg)</label>
                        <input type="number" id="peso" value="70" min="20" max="300" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="talla">Talla (cm)</label>
                        <input type="number" id="talla" value="175" min="100" max="250">
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label for="estres">Nivel de Estr√©s</label>
                        <select id="estres">
                            <option value="no">Bajo / Est√°ndar</option>
                            <option value="si">Alto (Sepsis/Trauma)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="refeeding">Riesgo Realimentaci√≥n</label>
                        <select id="refeeding">
                            <option value="no">No</option>
                            <option value="si">S√≠ (Desnutrici√≥n)</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label for="epoc">EPOC / Hipercapnia</label>
                        <select id="epoc">
                            <option value="no">No</option>
                            <option value="si">S√≠</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fistulas">P√©rdidas / F√≠stulas</label>
                        <select id="fistulas">
                            <option value="no">No</option>
                            <option value="si">S√≠</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top:20px;">
                <h2>2. Objetivos Nutricionales</h2>

                <div class="form-group">
                    <label>Calor√≠as Objetivo (kcal/kg/d) <span id="suggestion-badge" class="badge"
                            style="display:none; font-size:0.7em; background:var(--primary-glow); color:var(--primary); padding:2px 6px; border-radius:4px; margin-left:8px;"></span></label>
                    <input type="number" id="kcalKg" value="25" min="10" max="50" step="1">
                </div>

                <div class="form-group">
                    <label>Fase de Inicio (% de la meta) ‚Äî <span id="arranqueVal"
                            class="text-highlight">80</span>%</label>
                    <div class="range-wrap">
                        <span class="text-xs">25%</span>
                        <input type="range" id="arranque" min="0.25" max="1.0" step="0.05" value="0.8">
                        <span class="text-xs">100%</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Prote√≠nas (g/kg/d)</label>
                    <input type="number" id="protKg" value="1.5" min="0.5" max="3.0" step="0.1">
                </div>

                <div class="form-group">
                    <label>Reparto Cal√≥rico No Proteico</label>
                    <div class="range-wrap">
                        <span class="text-xs">Glucosa</span>
                        <input type="range" id="pctGluc" min="30" max="90" step="5" value="65">
                        <span class="text-xs">90%</span>
                    </div>
                    <div class="flex justify-between text-sm text-muted"
                        style="display:flex; justify-content:space-between; margin-top:4px;">
                        <span>Glucosa: <span id="pctGlucVal">65</span>%</span>
                        <span>L√≠pidos: <span id="pctLipVal">35</span>%</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Concentraci√≥n Amino√°cidos (%)</label>
                    <input type="number" id="aaPct" value="15" min="5" max="25">
                </div>
            </div>
        </aside>

        <!-- RIGHT PANEL: Results -->
        <main class="results-panel">
            <div class="card">
                <h2>Resultados del C√°lculo</h2>

                <div class="grid-3" style="margin-bottom:20px;">
                    <div class="kpi-box">
                        <div class="kpi-label">IMC</div>
                        <div class="kpi-value" id="res-imc">‚Äî</div>
                        <div class="kpi-sub" id="badge-obesity" style="display:none; color:var(--warning);">OBESIDAD
                        </div>
                    </div>
                    <div class="kpi-box">
                        <div class="kpi-label">PESO C√ÅLCULO</div>
                        <div class="kpi-value" id="res-weight-calc">‚Äî</div>
                        <div class="kpi-sub">Usado para dosis</div>
                    </div>
                    <div class="kpi-box" style="background:var(--primary-glow); border:1px solid var(--primary);">
                        <div class="kpi-label" style="color:var(--text-main);">KCAL TOTAL</div>
                        <div class="kpi-value" id="res-kcal-total">‚Äî</div>
                        <div class="kpi-sub">D√≠a Actual</div>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="kpi-box">
                        <div class="kpi-label">Prote√≠nas</div>
                        <div class="kpi-value" id="res-prot-g">‚Äî</div>
                        <div class="kpi-sub" style="font-size:0.85em; opacity:0.9;">(equiv. <span
                                id="res-nit-g">‚Äî</span> g Nitr√≥geno)</div>
                    </div>
                    <div class="kpi-box">
                        <div class="kpi-label">Volumen Total</div>
                        <div class="kpi-value" id="res-vol-total">‚Äî</div>
                        <div class="kpi-sub" style="color:var(--text-muted);">ml/d√≠a</div>
                    </div>
                </div>

                <div style="margin:20px 0;">
                    <div class="grid-3">
                        <div class="kpi-box">
                            <div class="kpi-label">Amino√°cidos</div>
                            <div class="kpi-value"><span id="val-aa-ml">‚Äî</span> ml</div>
                        </div>
                        <div class="kpi-box">
                            <div class="kpi-label">Dextrosa 50%</div>
                            <div class="kpi-value"><span id="val-gluc-ml">‚Äî</span> ml</div>
                            <div class="kpi-sub"><span id="val-gluc-g">‚Äî</span> g</div>
                        </div>
                        <div class="kpi-box">
                            <div class="kpi-label">L√≠pidos 20%</div>
                            <div class="kpi-value"><span id="val-lip-ml">‚Äî</span> ml</div>
                            <div class="kpi-sub"><span id="val-lip-g">‚Äî</span> g</div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-success" style="text-align:center; font-weight:bold;">
                    Ritmo de Infusi√≥n: <span id="res-rate" style="font-size:1.4em;">‚Äî</span> ml/h
                </div>
            </div>

            <!-- Safety Checks -->
            <div class="card" style="margin-top:20px;">
                <h2>Seguridad y Alertas</h2>
                <div id="alert-gluc" class="alert alert-success">Glucosa OK</div>
                <div id="alert-lip" class="alert alert-success">L√≠pidos OK</div>
                <div id="alert-ctx" class="alert alert-warning" style="display:none;"></div>
            </div>

            <!-- Prescription & Guide -->
            <div class="card" style="margin-top:20px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
                    <h2>4) Pasos para prescribir NP (coherente y did√°ctico)</h2>
                    <button id="btn-copy" class="btn btn-primary text-sm">
                        üìã Copiar Orden
                    </button>
                </div>

                <ol class="step-list text-sm" style="margin-bottom:24px;">
                    <li>
                        <strong>Valora v√≠a y momento:</strong> Si el tubo digestivo es utilizable, prioriza NE. NP
                        cuando NE sea imposible o insuficiente (&lt;60% tras 5‚Äì7 d√≠as) o desnutrici√≥n grave con
                        contraindicaci√≥n para NE.
                    </li>
                    <li>
                        <strong>Elige peso de c√°lculo:</strong> Usa <span class="mono">PA</span> si IMC ‚â• 30; en otros
                        casos, peso real.
                    </li>
                    <li>
                        <strong>Fija energ√≠a:</strong> <span class="mono" id="step-kcal-val">‚Äî</span>. Arranque d√≠as 1‚Äì3
                        al <span class="mono" id="step-start-pct">‚Äî</span> de la meta; d√≠a 4‚Äì7 subir a 100% si tolera.
                    </li>
                    <li>
                        <strong>Prote√≠nas:</strong> <span class="mono" id="step-prot-val">‚Äî</span>. Mant√©n aporte
                        proteico pleno aunque kcal sean hipocal√≥ricas al inicio.
                    </li>
                    <li>
                        <strong>No proteicas:</strong> Reparte en glucosa ~<span class="mono"
                            id="step-gluc-pct">‚Äî</span>% y l√≠pidos ~<span class="mono" id="step-lip-pct">‚Äî</span>%.
                        Calculado ‚Üí Glucosa <span class="mono" id="step-gluc-g">‚Äî</span> g (D50 <span class="mono"
                            id="step-gluc-ml">‚Äî</span> mL) y L√≠pidos <span class="mono" id="step-lip-g">‚Äî</span> g (20%
                        <span class="mono" id="step-lip-ml">‚Äî</span> mL).
                    </li>
                    <li>
                        <strong>Electrolitos & vitaminas:</strong> Na 1‚Äì2 mEq/kg/d; K 1‚Äì2 mEq/kg/d; P 20‚Äì40 mmol/d; Mg
                        8‚Äì20 mEq/d; Ca 10‚Äì15 mEq/d. Siempre a√±adir multivitam√≠nico y oligoelementos; considerar vitamina
                        K seg√∫n protocolo y zinc extra si p√©rdidas.
                    </li>
                    <li>
                        <strong>Volumen y ritmo:</strong> Volumen total estimado <span class="mono"
                            id="step-vol-total">‚Äî</span> mL/24 h ‚Üí ritmo <span class="mono" id="step-rate">‚Äî</span>
                        mL/h. Iniciar en perfusi√≥n continua 24 h.
                    </li>
                    <li>
                        <strong>Monitorizar y ajustar:</strong> Glucemia 140‚Äì180 mg/dL (insulina si precisa),
                        Na/K/Mg/P/Ca diarios al inicio, TG a 48‚Äì72 h (si &gt;400 mg/dL, reducir/pausar l√≠pidos), perfil
                        hep√°tico semanal, cuidado del cat√©ter, balance N 1‚Äì2/sem.
                    </li>
                    <li>
                        <strong>Transici√≥n a NE/oral:</strong> Reducir NP cuando NE/oral cubra ‚â•60% y suspender al
                        alcanzar objetivo con buena tolerancia.
                    </li>
                </ol>

                <textarea id="prescription-output" readonly
                    placeholder="La orden m√©dica se generar√° aqu√≠..."></textarea>
            </div>

            <!-- Safety Notes -->
            <div class="card" style="margin-top:20px;">
                <h2>Notas de seguridad, trucos y errores</h2>

                <div class="grid-2">
                    <div class="alert alert-warning"
                        style="background:var(--bg-input); border-color:var(--warning); color:var(--text-main);">
                        <strong style="color:var(--warning); display:block; margin-bottom:8px;">Precauciones
                            clave</strong>
                        <ul class="text-sm" style="padding-left:16px; margin:0;">
                            <li><strong>M√°ximo glucosa:</strong> ‚â§ 5 g/kg/d√≠a (‚âà ‚â§ 5 mg/kg/min). Mant√©n menor aporte si
                                hiperglucemia o EPOC.</li>
                            <li><strong>L√≠pidos:</strong> 0,7‚Äì1,0 g/kg/d√≠a (m√°x. 1,5). Triglic√©ridos: si &gt;400 mg/dL ‚Üí
                                reduce/pausa l√≠pidos.</li>
                            <li><strong>EPOC / hipercapnia:</strong> favorece distribuci√≥n con menor carga de glucosa
                                (p.ej., 50‚Äì60% de no proteicas) y evita superar los l√≠mites de infusi√≥n de glucosa para
                                no aumentar la producci√≥n de CO‚ÇÇ.</li>
                            <li><strong>Zinc extra:</strong> 10‚Äì20 mg/d si f√≠stulas, grandes p√©rdidas, diarrea o
                                quemaduras.</li>
                            <li><strong>Riesgo de realimentaci√≥n / desnutrici√≥n:</strong> iniciar al 25‚Äì50% + tiamina
                                100‚Äì200 mg IV/d y monitorizar estrechamente P‚ÄìK‚ÄìMg.</li>
                        </ul>
                    </div>

                    <div class="alert"
                        style="background:var(--bg-input); border-color:var(--primary); color:var(--text-main);">
                        <strong style="color:var(--primary); display:block; margin-bottom:8px;">Trucos y errores
                            frecuentes</strong>
                        <ul class="text-sm" style="padding-left:16px; margin:0;">
                            <li><strong>Error:</strong> dar 100% de kcal desde el d√≠a 1 ‚Üí <em>Mejor</em>: 70‚Äì80% y
                                subir.</li>
                            <li><strong>Error:</strong> olvidar vitaminas/oligoelementos ‚Üí <em>Siempre</em> a√±adirlos.
                            </li>
                            <li><strong>Error:</strong> exceder glucosa (&gt;5 g/kg/d) ‚Üí hiperglucemia/‚ÜëCO‚ÇÇ.</li>
                            <li><strong>Error:</strong> no vigilar <strong>P</strong> al inicio ‚Üí riesgo de
                                <strong>realimentaci√≥n</strong>.</li>
                            <li><strong>Error:</strong> ignorar <strong>TG</strong> ‚Üí si &gt;400 mg/dL, reduce l√≠pidos.
                            </li>
                            <li><strong>Error:</strong> no considerar <strong>peso ajustado</strong> en obesidad ‚Üí
                                sobreestimaci√≥n.</li>
                            <li><strong>Tip:</strong> prioriza <strong>prote√≠na plena</strong> aunque kcal sean
                                hipocal√≥ricas los primeros d√≠as.</li>
                            <li><strong>Tip:</strong> documenta <strong>Balance N</strong> 1‚Äì2/sem para seguir el
                                catabolismo.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/logic.js"></script>
    <script src="js/app.js"></script>
</body>

</html>